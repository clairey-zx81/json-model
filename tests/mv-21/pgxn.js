#! /bin/env node
// we may need require to load re2
import { createRequire } from 'node:module';
const require = createRequire(import.meta.url);
//
// Generated by JSON Model Compiler version 2.0b0
// see https://github.com/clairey-zx81/json-model
//
import * as runtime from "json_model_runtime"
const JSON_MODEL_VERSION = "2.0b0";

const _jm_re_0_re = new runtime.RX(".", "")
let _jm_cst_0 = new Set()
const _jm_re_1_re = new runtime.RX("^[Xx]_", "")
let _jm_cst_1 = new Set()
const _jm_re_2_re = new runtime.RX("^\\d+\\.\\d+\\.\\d+[-_A-Za-z0-9]*$", "")
const _jm_re_3_re = new runtime.RX("^(<=|<|>=|>|!=|==)$", "")
const _jm_re_4_re = new runtime.RX("^\\s*(<=|<|>=|>|!=|==)\\s*(\\d+\\.\\d+\\.\\d+[-_A-Za-z0-9]*)\\s*(,\\s*(<=|<|>=|>|!=|==)\\s*(\\d+\\.\\d+\\.\\d+[-_A-Za-z0-9]*))*\\s*$", "")
let _jm_cst_2 = new Set()
let _jm_cst_3 = new Set()
var _jm_obj_7_mup = new Map()
var _jm_obj_7_map = new Map()
var check_model_map = new Map()

const _jm_re_0 = (s) => _jm_re_0_re.exec(s) !== null

// check $neStr (.'$neStr')
function json_model_2(val, path, rep)
{
    let res;
    // .'$neStr'
    // "/./"
    res = ((typeof val === 'string' || val instanceof String)) && _jm_re_0(val, path, rep);
    if (! res)
    {
        rep !== null && rep.push(["unexpected /./ [.'$neStr']", path])
    }
    return res;
}

// check $neStrList (.'$neStrList')
function json_model_3(val, path, rep)
{
    let res;
    // .'$neStrList'
    // .'$neStrList'.'@'
    res = Array.isArray(val);
    if (res)
    {
        for (let arr_0_idx = 0; arr_0_idx < val.length; arr_0_idx++)
        {
            let arr_0_item = val[arr_0_idx]
            let arr_0_lpath = path ? path.concat([arr_0_idx]) : null;
            // .'$neStrList'.'@'.0
            res = json_model_2(arr_0_item, (path ? arr_0_lpath : null), rep);
            if (! res)
            {
                rep !== null && rep.push(["unexpected $neStr [.'$neStrList'.'@'.0]", (path ? arr_0_lpath : null)])
            }
            if (! res)
            {
                break;
            }
        }
    }
    if (! res)
    {
        rep !== null && rep.push(["not array or unexpected array [.'$neStrList'.'@']", path])
    }
    if (res)
    {
        let ival_0 = val.length;
        res = runtime.jm_array_is_unique(val, path, rep) && ival_0 >= 1;
        if (! res)
        {
            rep !== null && rep.push(["constraints failed [.'$neStrList']", path])
        }
    }
    return res;
}


// check $License (.'$License')
function json_model_4(val, path, rep)
{
    let res;
    // .'$License'
    res = ((val === null || (typeof val === 'number' || val instanceof Number) || (typeof val === 'boolean' || val instanceof Boolean) || (typeof val === 'string' || val instanceof String))) && _jm_cst_0.has(val);
    if (! res)
    {
        rep !== null && rep.push(["value not in enum [.'$License'.'|']", path])
    }
    return res;
}

// check $LicenseList (.'$LicenseList')
function json_model_5(val, path, rep)
{
    let res;
    // .'$LicenseList'
    // .'$LicenseList'.'@'
    res = Array.isArray(val);
    if (res)
    {
        for (let arr_1_idx = 0; arr_1_idx < val.length; arr_1_idx++)
        {
            let arr_1_item = val[arr_1_idx]
            let arr_1_lpath = path ? path.concat([arr_1_idx]) : null;
            // .'$LicenseList'.'@'.0
            res = json_model_4(arr_1_item, (path ? arr_1_lpath : null), rep);
            if (! res)
            {
                rep !== null && rep.push(["unexpected $License [.'$LicenseList'.'@'.0]", (path ? arr_1_lpath : null)])
            }
            if (! res)
            {
                break;
            }
        }
    }
    if (! res)
    {
        rep !== null && rep.push(["not array or unexpected array [.'$LicenseList'.'@']", path])
    }
    if (res)
    {
        let ival_1 = val.length;
        res = runtime.jm_array_is_unique(val, path, rep) && ival_1 >= 1;
        if (! res)
        {
            rep !== null && rep.push(["constraints failed [.'$LicenseList']", path])
        }
    }
    return res;
}

const _jm_re_1 = (s) => _jm_re_1_re.exec(s) !== null

// object .'$Provide'
function _jm_obj_0(val, path, rep)
{
    if (! (Object.prototype.toString.call(val) === '[object Object]'))
    {
        rep !== null && rep.push(["not an object [.'$Provide']", path])
        return false;
    }
    let res;
    let must_count = 0;
    for (const [prop, pval] of Object.entries(val))
    {
        let lpath_0 = path ? path.concat([prop]) : null;
        if (prop == "file")
        {
            // handle must file property
            must_count += 1;
            // .'$Provide'.file
            res = (typeof pval === 'string' || pval instanceof String);
            if (! res)
            {
                rep !== null && rep.push(["unexpected string [.'$Provide'.file]", (path ? lpath_0 : null)])
            }
            if (! res)
            {
                rep !== null && rep.push(["invalid mandatory prop value [.'$Provide'.file]", (path ? lpath_0 : null)])
                return false;
            }
        }
        else if (prop == "version")
        {
            // handle must version property
            must_count += 1;
            // .'$Provide'.version
            res = json_model_10(pval, (path ? lpath_0 : null), rep);
            if (! res)
            {
                rep !== null && rep.push(["unexpected $Version [.'$Provide'.version]", (path ? lpath_0 : null)])
            }
            if (! res)
            {
                rep !== null && rep.push(["invalid mandatory prop value [.'$Provide'.version]", (path ? lpath_0 : null)])
                return false;
            }
        }
        else if (prop == "abstract")
        {
            // handle may abstract property
            // .'$Provide'.abstract
            res = (typeof pval === 'string' || pval instanceof String);
            if (! res)
            {
                rep !== null && rep.push(["unexpected string [.'$Provide'.abstract]", (path ? lpath_0 : null)])
            }
            if (! res)
            {
                rep !== null && rep.push(["invalid optional prop value [.'$Provide'.abstract]", (path ? lpath_0 : null)])
                return false;
            }
        }
        else if (prop == "docfile")
        {
            // handle may docfile property
            // .'$Provide'.docfile
            res = (typeof pval === 'string' || pval instanceof String);
            if (! res)
            {
                rep !== null && rep.push(["unexpected string [.'$Provide'.docfile]", (path ? lpath_0 : null)])
            }
            if (! res)
            {
                rep !== null && rep.push(["invalid optional prop value [.'$Provide'.docfile]", (path ? lpath_0 : null)])
                return false;
            }
        }
        else if (_jm_re_1(prop, path, rep))
        {
            // handle 1 re props
            // .'$Provide'.'/^[Xx]_/'
            res = true;
            if (! res)
            {
                rep !== null && rep.push(["unexpected $ANY [.'$Provide'.'/^[Xx]_/']", (path ? lpath_0 : null)])
            }
            if (! res)
            {
                return false;
            }
        }
        else
        {
            rep !== null && rep.push(["unexpected prop [.'$Provide']", (path ? lpath_0 : null)])
            return false;
        }
    }
    if (must_count != 2)
    {
        if (rep !== null)
        {
            if (! val.hasOwnProperty("file"))
            {
                rep !== null && rep.push(["missing mandatory prop <file> [.'$Provide']", path])
            }
            if (! val.hasOwnProperty("version"))
            {
                rep !== null && rep.push(["missing mandatory prop <version> [.'$Provide']", path])
            }
        }
        return false;
    }
    return true;
}

// check $Provide (.'$Provide')
function json_model_6(val, path, rep)
{
    let res;
    // .'$Provide'
    res = _jm_obj_0(val, path, rep);
    if (! res)
    {
        rep !== null && rep.push(["unexpected element [.'$Provide']", path])
    }
    return res;
}


// check $Status (.'$Status')
function json_model_7(val, path, rep)
{
    let res;
    // .'$Status'
    res = ((val === null || (typeof val === 'number' || val instanceof Number) || (typeof val === 'boolean' || val instanceof Boolean) || (typeof val === 'string' || val instanceof String))) && _jm_cst_1.has(val);
    if (! res)
    {
        rep !== null && rep.push(["value not in enum [.'$Status'.'|']", path])
    }
    return res;
}

// object .'$Resources'.bugtracker
function _jm_obj_2(val, path, rep)
{
    if (! (Object.prototype.toString.call(val) === '[object Object]'))
    {
        rep !== null && rep.push(["not an object [.'$Resources'.bugtracker]", path])
        return false;
    }
    let res;
    for (const [prop, pval] of Object.entries(val))
    {
        let lpath_2 = path ? path.concat([prop]) : null;
        if (prop == "web")
        {
            // handle may web property
            // .'$Resources'.bugtracker.web
            res = runtime.jm_is_valid_url(pval);
            if (! res)
            {
                rep !== null && rep.push(["unexpected $URL [.'$Resources'.bugtracker.web]", (path ? lpath_2 : null)])
            }
            if (! res)
            {
                rep !== null && rep.push(["invalid optional prop value [.'$Resources'.bugtracker.web]", (path ? lpath_2 : null)])
                return false;
            }
        }
        else if (prop == "mailto")
        {
            // handle may mailto property
            // .'$Resources'.bugtracker.mailto
            res = runtime.jm_is_valid_email(pval);
            if (! res)
            {
                rep !== null && rep.push(["unexpected $EMAIL [.'$Resources'.bugtracker.mailto]", (path ? lpath_2 : null)])
            }
            if (! res)
            {
                rep !== null && rep.push(["invalid optional prop value [.'$Resources'.bugtracker.mailto]", (path ? lpath_2 : null)])
                return false;
            }
        }
        else if (_jm_re_1(prop, path, rep))
        {
            // handle 1 re props
            // .'$Resources'.bugtracker.'/^[Xx]_/'
            res = true;
            if (! res)
            {
                rep !== null && rep.push(["unexpected $ANY [.'$Resources'.bugtracker.'/^[Xx]_/']", (path ? lpath_2 : null)])
            }
            if (! res)
            {
                return false;
            }
        }
        else
        {
            rep !== null && rep.push(["unexpected prop [.'$Resources'.bugtracker]", (path ? lpath_2 : null)])
            return false;
        }
    }
    return true;
}

// object .'$Resources'.repository
function _jm_obj_3(val, path, rep)
{
    if (! (Object.prototype.toString.call(val) === '[object Object]'))
    {
        rep !== null && rep.push(["not an object [.'$Resources'.repository]", path])
        return false;
    }
    let res;
    for (const [prop, pval] of Object.entries(val))
    {
        let lpath_3 = path ? path.concat([prop]) : null;
        if (prop == "url")
        {
            // handle may url property
            // .'$Resources'.repository.url
            res = runtime.jm_is_valid_url(pval);
            if (! res)
            {
                rep !== null && rep.push(["unexpected $URL [.'$Resources'.repository.url]", (path ? lpath_3 : null)])
            }
            if (! res)
            {
                rep !== null && rep.push(["invalid optional prop value [.'$Resources'.repository.url]", (path ? lpath_3 : null)])
                return false;
            }
        }
        else if (prop == "web")
        {
            // handle may web property
            // .'$Resources'.repository.web
            res = runtime.jm_is_valid_url(pval);
            if (! res)
            {
                rep !== null && rep.push(["unexpected $URL [.'$Resources'.repository.web]", (path ? lpath_3 : null)])
            }
            if (! res)
            {
                rep !== null && rep.push(["invalid optional prop value [.'$Resources'.repository.web]", (path ? lpath_3 : null)])
                return false;
            }
        }
        else if (prop == "type")
        {
            // handle may type property
            // .'$Resources'.repository.type
            // "/./"
            res = ((typeof pval === 'string' || pval instanceof String)) && _jm_re_0(pval, (path ? lpath_3 : null), rep);
            if (! res)
            {
                rep !== null && rep.push(["unexpected /./ [.'$Resources'.repository.type]", (path ? lpath_3 : null)])
            }
            if (! res)
            {
                rep !== null && rep.push(["invalid optional prop value [.'$Resources'.repository.type]", (path ? lpath_3 : null)])
                return false;
            }
        }
        else
        {
            rep !== null && rep.push(["unexpected prop [.'$Resources'.repository]", (path ? lpath_3 : null)])
            return false;
        }
    }
    return true;
}

// object .'$Resources'
function _jm_obj_1(val, path, rep)
{
    if (! (Object.prototype.toString.call(val) === '[object Object]'))
    {
        rep !== null && rep.push(["not an object [.'$Resources']", path])
        return false;
    }
    let res;
    for (const [prop, pval] of Object.entries(val))
    {
        let lpath_1 = path ? path.concat([prop]) : null;
        if (prop == "homepage")
        {
            // handle may homepage property
            // .'$Resources'.homepage
            res = runtime.jm_is_valid_url(pval);
            if (! res)
            {
                rep !== null && rep.push(["unexpected $URL [.'$Resources'.homepage]", (path ? lpath_1 : null)])
            }
            if (! res)
            {
                rep !== null && rep.push(["invalid optional prop value [.'$Resources'.homepage]", (path ? lpath_1 : null)])
                return false;
            }
        }
        else if (prop == "bugtracker")
        {
            // handle may bugtracker property
            // .'$Resources'.bugtracker
            res = _jm_obj_2(pval, (path ? lpath_1 : null), rep);
            if (! res)
            {
                rep !== null && rep.push(["unexpected element [.'$Resources'.bugtracker]", (path ? lpath_1 : null)])
            }
            if (! res)
            {
                rep !== null && rep.push(["invalid optional prop value [.'$Resources'.bugtracker]", (path ? lpath_1 : null)])
                return false;
            }
        }
        else if (prop == "repository")
        {
            // handle may repository property
            // .'$Resources'.repository
            res = _jm_obj_3(pval, (path ? lpath_1 : null), rep);
            if (! res)
            {
                rep !== null && rep.push(["unexpected element [.'$Resources'.repository]", (path ? lpath_1 : null)])
            }
            if (! res)
            {
                rep !== null && rep.push(["invalid optional prop value [.'$Resources'.repository]", (path ? lpath_1 : null)])
                return false;
            }
        }
        else
        {
            rep !== null && rep.push(["unexpected prop [.'$Resources']", (path ? lpath_1 : null)])
            return false;
        }
    }
    return true;
}

// check $Resources (.'$Resources')
function json_model_8(val, path, rep)
{
    let res;
    // .'$Resources'
    res = _jm_obj_1(val, path, rep);
    if (! res)
    {
        rep !== null && rep.push(["unexpected element [.'$Resources']", path])
    }
    return res;
}

const _jm_re_2 = (s) => _jm_re_2_re.exec(s) !== null

// check $SemVer (.'$SemVer')
function json_model_9(val, path, rep)
{
    let res;
    // .'$SemVer'
    // "/^\\d+\\.\\d+\\.\\d+[-_A-Za-z0-9]*$/"
    res = ((typeof val === 'string' || val instanceof String)) && _jm_re_2(val, path, rep);
    if (! res)
    {
        rep !== null && rep.push(["unexpected /^\\d+\\.\\d+\\.\\d+[-_A-Za-z0-9]*$/ [.'$SemVer']", path])
    }
    return res;
}

// check $Version (.'$Version')
function json_model_10(val, path, rep)
{
    let res;
    // .'$Version'
    // .'$Version'.'|'.0
    res = json_model_9(val, path, rep);
    if (! res)
    {
        rep !== null && rep.push(["unexpected $SemVer [.'$Version'.'|'.0]", path])
    }
    if (! res)
    {
        // .'$Version'.'|'.1
        res = ((typeof val === 'number' || val instanceof Number) && Number.isInteger(val)) && val == 0;
        if (! res)
        {
            rep !== null && rep.push(["unexpected =0 [.'$Version'.'|'.1]", path])
        }
    }
    if (res)
    {
        if (rep !== null) rep.length = 0
    }
    else
    {
        rep !== null && rep.push(["no model matched [.'$Version'.'|']", path])
    }
    return res;
}

const _jm_re_3 = (s) => _jm_re_3_re.exec(s) !== null

// check $Ops (.'$Ops')
function json_model_11(val, path, rep)
{
    let res;
    // .'$Ops'
    // "/^(<=|<|>=|>|!=|==)$/"
    res = ((typeof val === 'string' || val instanceof String)) && _jm_re_3(val, path, rep);
    if (! res)
    {
        rep !== null && rep.push(["unexpected /^(<=|<|>=|>|!=|==)$/ [.'$Ops']", path])
    }
    return res;
}

const _jm_re_4 = (s) => _jm_re_4_re.exec(s) !== null

// check $VersionRange (.'$VersionRange')
function json_model_12(val, path, rep)
{
    let res;
    // .'$VersionRange'
    // "/^\\s*(<=|<|>=|>|!=|==)\\s*(\\d+\\.\\d+\\.\\d+[-_A-Za-z0-9]*)\\s*(,\\s*(<=|<|>=|>|!=|==)\\s*(\\d+\\.\\d+\\.\\d+[-_A-Za-z0-9]*))*\\s*$/"
    res = ((typeof val === 'string' || val instanceof String)) && _jm_re_4(val, path, rep);
    if (! res)
    {
        rep !== null && rep.push(["unexpected /^\\s*(<=|<|>=|>|!=|==)\\s*(\\d+\\.\\d+\\.\\d+[-_A-Za-z0-9]*)\\s*(,\\s*(<=|<|>=|>|!=|==)\\s*(\\d+\\.\\d+\\.\\d+[-_A-Za-z0-9]*))*\\s*$/ [.'$VersionRange']", path])
    }
    return res;
}


// check $Phase (.'$Phase')
function json_model_13(val, path, rep)
{
    let res;
    // .'$Phase'
    res = ((val === null || (typeof val === 'number' || val instanceof Number) || (typeof val === 'boolean' || val instanceof Boolean) || (typeof val === 'string' || val instanceof String))) && _jm_cst_2.has(val);
    if (! res)
    {
        rep !== null && rep.push(["value not in enum [.'$Phase'.'|']", path])
    }
    return res;
}


// check $Relation (.'$Relation')
function json_model_14(val, path, rep)
{
    let res;
    // .'$Relation'
    res = ((val === null || (typeof val === 'number' || val instanceof Number) || (typeof val === 'boolean' || val instanceof Boolean) || (typeof val === 'string' || val instanceof String))) && _jm_cst_3.has(val);
    if (! res)
    {
        rep !== null && rep.push(["value not in enum [.'$Relation'.'|']", path])
    }
    return res;
}

// object .'$Prereq'
function _jm_obj_4(val, path, rep)
{
    if (! (Object.prototype.toString.call(val) === '[object Object]'))
    {
        rep !== null && rep.push(["not an object [.'$Prereq']", path])
        return false;
    }
    let res;
    for (const [prop, pval] of Object.entries(val))
    {
        let lpath_4 = path ? path.concat([prop]) : null;
        // handle other props
        // .'$Prereq'.''
        // .'$Prereq'.''.'|'.0
        res = json_model_10(pval, (path ? lpath_4 : null), rep);
        if (! res)
        {
            rep !== null && rep.push(["unexpected $Version [.'$Prereq'.''.'|'.0]", (path ? lpath_4 : null)])
        }
        if (! res)
        {
            // .'$Prereq'.''.'|'.1
            res = json_model_12(pval, (path ? lpath_4 : null), rep);
            if (! res)
            {
                rep !== null && rep.push(["unexpected $VersionRange [.'$Prereq'.''.'|'.1]", (path ? lpath_4 : null)])
            }
        }
        if (res)
        {
            if (rep !== null) rep.length = 0
        }
        else
        {
            rep !== null && rep.push(["no model matched [.'$Prereq'.''.'|']", (path ? lpath_4 : null)])
        }
        if (! res)
        {
            return false;
        }
    }
    return true;
}

// check $Prereq (.'$Prereq')
function json_model_15(val, path, rep)
{
    let res;
    // .'$Prereq'
    res = _jm_obj_4(val, path, rep);
    if (! res)
    {
        rep !== null && rep.push(["unexpected element [.'$Prereq']", path])
    }
    return res;
}

// object .'$Prereqs'.'$Phase'
function _jm_obj_6(val, path, rep)
{
    if (! (Object.prototype.toString.call(val) === '[object Object]'))
    {
        rep !== null && rep.push(["not an object [.'$Prereqs'.'$Phase']", path])
        return false;
    }
    let res;
    for (const [prop, pval] of Object.entries(val))
    {
        let lpath_6 = path ? path.concat([prop]) : null;
        if (json_model_14(prop, (path ? lpath_6 : null), rep))
        {
            // handle 1 key props
            // .'$Prereqs'.'$Phase'.'$Relation'
            res = json_model_15(pval, (path ? lpath_6 : null), rep);
            if (! res)
            {
                rep !== null && rep.push(["unexpected $Prereq [.'$Prereqs'.'$Phase'.'$Relation']", (path ? lpath_6 : null)])
            }
            if (! res)
            {
                return false;
            }
        }
        else if (_jm_re_1(prop, path, rep))
        {
            // handle 1 re props
            // .'$Prereqs'.'$Phase'.'/^[Xx]_/'
            res = true;
            if (! res)
            {
                rep !== null && rep.push(["unexpected $ANY [.'$Prereqs'.'$Phase'.'/^[Xx]_/']", (path ? lpath_6 : null)])
            }
            if (! res)
            {
                return false;
            }
        }
        else
        {
            rep !== null && rep.push(["unexpected prop [.'$Prereqs'.'$Phase']", (path ? lpath_6 : null)])
            return false;
        }
    }
    return true;
}

// object .'$Prereqs'
function _jm_obj_5(val, path, rep)
{
    if (! (Object.prototype.toString.call(val) === '[object Object]'))
    {
        rep !== null && rep.push(["not an object [.'$Prereqs']", path])
        return false;
    }
    let res;
    for (const [prop, pval] of Object.entries(val))
    {
        let lpath_5 = path ? path.concat([prop]) : null;
        if (json_model_13(prop, (path ? lpath_5 : null), rep))
        {
            // handle 1 key props
            // .'$Prereqs'.'$Phase'
            res = _jm_obj_6(pval, (path ? lpath_5 : null), rep);
            if (! res)
            {
                rep !== null && rep.push(["unexpected element [.'$Prereqs'.'$Phase']", (path ? lpath_5 : null)])
            }
            if (! res)
            {
                return false;
            }
        }
        else if (_jm_re_1(prop, path, rep))
        {
            // handle 1 re props
            // .'$Prereqs'.'/^[Xx]_/'
            res = true;
            if (! res)
            {
                rep !== null && rep.push(["unexpected $ANY [.'$Prereqs'.'/^[Xx]_/']", (path ? lpath_5 : null)])
            }
            if (! res)
            {
                return false;
            }
        }
        else
        {
            rep !== null && rep.push(["unexpected prop [.'$Prereqs']", (path ? lpath_5 : null)])
            return false;
        }
    }
    return true;
}

// check $Prereqs (.'$Prereqs')
function json_model_16(val, path, rep)
{
    let res;
    // .'$Prereqs'
    res = _jm_obj_5(val, path, rep);
    if (! res)
    {
        rep !== null && rep.push(["unexpected element [.'$Prereqs']", path])
    }
    return res;
}

// check _jm_obj_7_mup_abstract (.abstract)
function _jm_f_0(val, path, rep)
{
    let res;
    // .abstract
    res = (typeof val === 'string' || val instanceof String);
    if (! res)
    {
        rep !== null && rep.push(["unexpected string [.abstract]", path])
    }
    return res;
}

// object .license.'^'.2
function _jm_obj_8(val, path, rep)
{
    if (! (Object.prototype.toString.call(val) === '[object Object]'))
    {
        rep !== null && rep.push(["not an object [.license.'^'.2]", path])
        return false;
    }
    let res;
    for (const [prop, pval] of Object.entries(val))
    {
        let lpath_8 = path ? path.concat([prop]) : null;
        // handle other props
        // .license.'^'.2.''
        res = runtime.jm_is_valid_url(pval);
        if (! res)
        {
            rep !== null && rep.push(["unexpected $URL [.license.'^'.2.'']", (path ? lpath_8 : null)])
        }
        if (! res)
        {
            return false;
        }
    }
    return true;
}

// check _jm_obj_7_mup_license (.license)
function _jm_f_1(val, path, rep)
{
    let res;
    // .license
    // generic xor list
    let xc_0 = 0;
    let xr_0;
    // .license.'^'.0
    xr_0 = json_model_4(val, path, rep);
    if (! xr_0)
    {
        rep !== null && rep.push(["unexpected $License [.license.'^'.0]", path])
    }
    if (xr_0)
    {
        xc_0 += 1;
    }
    // .license.'^'.1
    xr_0 = json_model_5(val, path, rep);
    if (! xr_0)
    {
        rep !== null && rep.push(["unexpected $LicenseList [.license.'^'.1]", path])
    }
    if (xr_0)
    {
        xc_0 += 1;
    }
    if (xc_0 <= 1)
    {
        // .license.'^'.2
        xr_0 = _jm_obj_8(val, path, rep);
        if (! xr_0)
        {
            rep !== null && rep.push(["unexpected element [.license.'^'.2]", path])
        }
        if (xr_0)
        {
            xc_0 += 1;
        }
    }
    res = xc_0 == 1;
    if (res)
    {
        if (rep !== null) rep.length = 0
    }
    else
    {
        rep !== null && rep.push(["not one model match [.license.'^']", path])
    }
    return res;
}

// check _jm_obj_7_mup_maintainer (.maintainer)
function _jm_f_2(val, path, rep)
{
    let res;
    // .maintainer
    // .maintainer.'|'.0
    res = json_model_2(val, path, rep);
    if (! res)
    {
        rep !== null && rep.push(["unexpected $neStr [.maintainer.'|'.0]", path])
    }
    if (! res)
    {
        // .maintainer.'|'.1
        res = json_model_3(val, path, rep);
        if (! res)
        {
            rep !== null && rep.push(["unexpected $neStrList [.maintainer.'|'.1]", path])
        }
    }
    if (res)
    {
        if (rep !== null) rep.length = 0
    }
    else
    {
        rep !== null && rep.push(["no model matched [.maintainer.'|']", path])
    }
    return res;
}

// object .'meta-spec'
function _jm_obj_9(val, path, rep)
{
    if (! (Object.prototype.toString.call(val) === '[object Object]'))
    {
        rep !== null && rep.push(["not an object [.'meta-spec']", path])
        return false;
    }
    let res;
    let must_count = 0;
    for (const [prop, pval] of Object.entries(val))
    {
        let lpath_9 = path ? path.concat([prop]) : null;
        if (prop == "version")
        {
            // handle must version property
            must_count += 1;
            // .'meta-spec'.version
            res = ((typeof pval === 'string' || pval instanceof String)) && pval == "1.0.0";
            if (! res)
            {
                rep !== null && rep.push(["unexpected _1.0.0 [.'meta-spec'.version]", (path ? lpath_9 : null)])
            }
            if (! res)
            {
                rep !== null && rep.push(["invalid mandatory prop value [.'meta-spec'.version]", (path ? lpath_9 : null)])
                return false;
            }
        }
        else if (prop == "url")
        {
            // handle may url property
            // .'meta-spec'.url
            res = runtime.jm_is_valid_url(pval);
            if (! res)
            {
                rep !== null && rep.push(["unexpected $URL [.'meta-spec'.url]", (path ? lpath_9 : null)])
            }
            if (! res)
            {
                rep !== null && rep.push(["invalid optional prop value [.'meta-spec'.url]", (path ? lpath_9 : null)])
                return false;
            }
        }
        else if (_jm_re_1(prop, path, rep))
        {
            // handle 1 re props
            // .'meta-spec'.'/^[Xx]_/'
            res = true;
            if (! res)
            {
                rep !== null && rep.push(["unexpected $ANY [.'meta-spec'.'/^[Xx]_/']", (path ? lpath_9 : null)])
            }
            if (! res)
            {
                return false;
            }
        }
        else
        {
            rep !== null && rep.push(["unexpected prop [.'meta-spec']", (path ? lpath_9 : null)])
            return false;
        }
    }
    if (must_count != 1)
    {
        if (rep !== null)
        {
            if (! val.hasOwnProperty("version"))
            {
                rep !== null && rep.push(["missing mandatory prop <version> [.'meta-spec']", path])
            }
        }
        return false;
    }
    return true;
}

// check _jm_obj_7_mup_meta-spec (.'meta-spec')
function _jm_f_3(val, path, rep)
{
    let res;
    // .'meta-spec'
    res = _jm_obj_9(val, path, rep);
    if (! res)
    {
        rep !== null && rep.push(["unexpected element [.'meta-spec']", path])
    }
    return res;
}

// check _jm_obj_7_mup_name (.name)
function _jm_f_4(val, path, rep)
{
    let res;
    // .name
    res = json_model_2(val, path, rep);
    if (! res)
    {
        rep !== null && rep.push(["unexpected $neStr [.name]", path])
    }
    return res;
}

// object .provides
function _jm_obj_10(val, path, rep)
{
    if (! (Object.prototype.toString.call(val) === '[object Object]'))
    {
        rep !== null && rep.push(["not an object [.provides]", path])
        return false;
    }
    let res;
    for (const [prop, pval] of Object.entries(val))
    {
        let lpath_10 = path ? path.concat([prop]) : null;
        // handle other props
        // .provides.''
        res = json_model_6(pval, (path ? lpath_10 : null), rep);
        if (! res)
        {
            rep !== null && rep.push(["unexpected $Provide [.provides.'']", (path ? lpath_10 : null)])
        }
        if (! res)
        {
            return false;
        }
    }
    return true;
}

// check _jm_obj_7_mup_provides (.provides)
function _jm_f_5(val, path, rep)
{
    let res;
    // .provides
    res = _jm_obj_10(val, path, rep);
    if (! res)
    {
        rep !== null && rep.push(["unexpected element [.provides]", path])
    }
    return res;
}

// check _jm_obj_7_mup_version (.version)
function _jm_f_6(val, path, rep)
{
    let res;
    // .version
    res = (typeof val === 'string' || val instanceof String);
    if (! res)
    {
        rep !== null && rep.push(["unexpected string [.version]", path])
    }
    return res;
}


// check _jm_obj_7_map_description (.description)
function _jm_f_7(val, path, rep)
{
    let res;
    // .description
    res = (typeof val === 'string' || val instanceof String);
    if (! res)
    {
        rep !== null && rep.push(["unexpected string [.description]", path])
    }
    return res;
}

// check _jm_obj_7_map_generated_by (.generated_by)
function _jm_f_8(val, path, rep)
{
    let res;
    // .generated_by
    res = (typeof val === 'string' || val instanceof String);
    if (! res)
    {
        rep !== null && rep.push(["unexpected string [.generated_by]", path])
    }
    return res;
}

// object .no_index
function _jm_obj_11(val, path, rep)
{
    if (! (Object.prototype.toString.call(val) === '[object Object]'))
    {
        rep !== null && rep.push(["not an object [.no_index]", path])
        return false;
    }
    let res;
    for (const [prop, pval] of Object.entries(val))
    {
        let lpath_11 = path ? path.concat([prop]) : null;
        if (prop == "file")
        {
            // handle may file property
            // .no_index.file
            res = json_model_3(pval, (path ? lpath_11 : null), rep);
            if (! res)
            {
                rep !== null && rep.push(["unexpected $neStrList [.no_index.file]", (path ? lpath_11 : null)])
            }
            if (! res)
            {
                rep !== null && rep.push(["invalid optional prop value [.no_index.file]", (path ? lpath_11 : null)])
                return false;
            }
        }
        else if (prop == "directory")
        {
            // handle may directory property
            // .no_index.directory
            res = json_model_3(pval, (path ? lpath_11 : null), rep);
            if (! res)
            {
                rep !== null && rep.push(["unexpected $neStrList [.no_index.directory]", (path ? lpath_11 : null)])
            }
            if (! res)
            {
                rep !== null && rep.push(["invalid optional prop value [.no_index.directory]", (path ? lpath_11 : null)])
                return false;
            }
        }
        else
        {
            rep !== null && rep.push(["unexpected prop [.no_index]", (path ? lpath_11 : null)])
            return false;
        }
    }
    return true;
}

// check _jm_obj_7_map_no_index (.no_index)
function _jm_f_9(val, path, rep)
{
    let res;
    // .no_index
    res = _jm_obj_11(val, path, rep);
    if (! res)
    {
        rep !== null && rep.push(["unexpected element [.no_index]", path])
    }
    return res;
}

// check _jm_obj_7_map_prereqs (.prereqs)
function _jm_f_10(val, path, rep)
{
    let res;
    // .prereqs
    res = json_model_16(val, path, rep);
    if (! res)
    {
        rep !== null && rep.push(["unexpected $Prereqs [.prereqs]", path])
    }
    return res;
}

// check _jm_obj_7_map_release_status (.release_status)
function _jm_f_11(val, path, rep)
{
    let res;
    // .release_status
    res = json_model_7(val, path, rep);
    if (! res)
    {
        rep !== null && rep.push(["unexpected $Status [.release_status]", path])
    }
    return res;
}

// check _jm_obj_7_map_resources (.resources)
function _jm_f_12(val, path, rep)
{
    let res;
    // .resources
    res = json_model_8(val, path, rep);
    if (! res)
    {
        rep !== null && rep.push(["unexpected $Resources [.resources]", path])
    }
    return res;
}

// check _jm_obj_7_map_tags (.tags)
function _jm_f_13(val, path, rep)
{
    let res;
    // .tags
    res = json_model_3(val, path, rep);
    if (! res)
    {
        rep !== null && rep.push(["unexpected $neStrList [.tags]", path])
    }
    return res;
}

// check _jm_obj_7_map_url (.url)
function _jm_f_14(val, path, rep)
{
    let res;
    // .url
    res = runtime.jm_is_valid_url(val);
    if (! res)
    {
        rep !== null && rep.push(["unexpected $URL [.url]", path])
    }
    return res;
}


// object .
function _jm_obj_7(val, path, rep)
{
    if (! (Object.prototype.toString.call(val) === '[object Object]'))
    {
        rep !== null && rep.push(["not an object [.]", path])
        return false;
    }
    let res;
    let pfun;
    let must_count = 0;
    for (const [prop, pval] of Object.entries(val))
    {
        let lpath_7 = path ? path.concat([prop]) : null;
        if ((pfun = _jm_obj_7_mup.get(prop)))
        {
            // handle 7 mandatory props
            if (pfun !== undefined)
            {
                must_count += 1;
                if (! pfun(pval, (path ? lpath_7 : null), rep))
                {
                    rep !== null && rep.push(["invalid mandatory prop value [.]", (path ? lpath_7 : null)])
                    return false;
                }
            }
        }
        else if ((pfun = _jm_obj_7_map.get(prop)))
        {
            // handle 8 may props
            if (pfun !== undefined && ! pfun(pval, (path ? lpath_7 : null), rep))
            {
                rep !== null && rep.push(["invalid optional prop value [.]", (path ? lpath_7 : null)])
                return false;
            }
        }
        else if (_jm_re_1(prop, path, rep))
        {
            // handle 1 re props
            // .'/^[Xx]_/'
            res = true;
            if (! res)
            {
                rep !== null && rep.push(["unexpected $ANY [.'/^[Xx]_/']", (path ? lpath_7 : null)])
            }
            if (! res)
            {
                return false;
            }
        }
        else
        {
            rep !== null && rep.push(["unexpected prop [.]", (path ? lpath_7 : null)])
            return false;
        }
    }
    if (must_count != 7)
    {
        if (rep !== null)
        {
            if (! val.hasOwnProperty("abstract"))
            {
                rep !== null && rep.push(["missing mandatory prop <abstract> [.]", path])
            }
            if (! val.hasOwnProperty("license"))
            {
                rep !== null && rep.push(["missing mandatory prop <license> [.]", path])
            }
            if (! val.hasOwnProperty("maintainer"))
            {
                rep !== null && rep.push(["missing mandatory prop <maintainer> [.]", path])
            }
            if (! val.hasOwnProperty("meta-spec"))
            {
                rep !== null && rep.push(["missing mandatory prop <meta-spec> [.]", path])
            }
            if (! val.hasOwnProperty("name"))
            {
                rep !== null && rep.push(["missing mandatory prop <name> [.]", path])
            }
            if (! val.hasOwnProperty("provides"))
            {
                rep !== null && rep.push(["missing mandatory prop <provides> [.]", path])
            }
            if (! val.hasOwnProperty("version"))
            {
                rep !== null && rep.push(["missing mandatory prop <version> [.]", path])
            }
        }
        return false;
    }
    return true;
}

// check $ (.)
function json_model_1(val, path, rep)
{
    let res;
    // .
    res = _jm_obj_7(val, path, rep);
    if (! res)
    {
        rep !== null && rep.push(["unexpected element [.]", path])
    }
    return res;
}


var initialized = false

// differed module initializations
export function check_model_init()
{
    if (! initialized)
    {
        initialized = true;
        runtime.jm_set_rx(RegExp)
        _jm_cst_0.add("agpl_3")
        _jm_cst_0.add("apache_1_1")
        _jm_cst_0.add("apache_2_0")
        _jm_cst_0.add("artistic_1")
        _jm_cst_0.add("artistic_2")
        _jm_cst_0.add("bsd")
        _jm_cst_0.add("freebsd")
        _jm_cst_0.add("gfdl_1_2")
        _jm_cst_0.add("gfdl_1_3")
        _jm_cst_0.add("gpl_1")
        _jm_cst_0.add("gpl_2")
        _jm_cst_0.add("gpl_3")
        _jm_cst_0.add("lgpl_2_1")
        _jm_cst_0.add("lgpl_3_0")
        _jm_cst_0.add("mit")
        _jm_cst_0.add("mozilla_1_0")
        _jm_cst_0.add("mozilla_1_1")
        _jm_cst_0.add("openssl")
        _jm_cst_0.add("perl_5")
        _jm_cst_0.add("postgresql")
        _jm_cst_0.add("qpl_1_0")
        _jm_cst_0.add("ssleay")
        _jm_cst_0.add("sun")
        _jm_cst_0.add("zlib")
        _jm_cst_0.add("open_source")
        _jm_cst_0.add("restricted")
        _jm_cst_0.add("unrestricted")
        _jm_cst_0.add("unknown")
        _jm_cst_1.add("stable")
        _jm_cst_1.add("testing")
        _jm_cst_1.add("unstable")
        _jm_cst_2.add("configure")
        _jm_cst_2.add("build")
        _jm_cst_2.add("test")
        _jm_cst_2.add("runtime")
        _jm_cst_2.add("develop")
        _jm_cst_3.add("requires")
        _jm_cst_3.add("recommends")
        _jm_cst_3.add("suggests")
        _jm_cst_3.add("conflicts")
        _jm_obj_7_mup.set("abstract", _jm_f_0)
        _jm_obj_7_mup.set("license", _jm_f_1)
        _jm_obj_7_mup.set("maintainer", _jm_f_2)
        _jm_obj_7_mup.set("meta-spec", _jm_f_3)
        _jm_obj_7_mup.set("name", _jm_f_4)
        _jm_obj_7_mup.set("provides", _jm_f_5)
        _jm_obj_7_mup.set("version", _jm_f_6)
        _jm_obj_7_map.set("description", _jm_f_7)
        _jm_obj_7_map.set("generated_by", _jm_f_8)
        _jm_obj_7_map.set("no_index", _jm_f_9)
        _jm_obj_7_map.set("prereqs", _jm_f_10)
        _jm_obj_7_map.set("release_status", _jm_f_11)
        _jm_obj_7_map.set("resources", _jm_f_12)
        _jm_obj_7_map.set("tags", _jm_f_13)
        _jm_obj_7_map.set("url", _jm_f_14)
        check_model_map.set("", json_model_1)
        check_model_map.set("neStr", json_model_2)
        check_model_map.set("neStrList", json_model_3)
        check_model_map.set("License", json_model_4)
        check_model_map.set("LicenseList", json_model_5)
        check_model_map.set("Provide", json_model_6)
        check_model_map.set("Status", json_model_7)
        check_model_map.set("Resources", json_model_8)
        check_model_map.set("SemVer", json_model_9)
        check_model_map.set("Version", json_model_10)
        check_model_map.set("Ops", json_model_11)
        check_model_map.set("VersionRange", json_model_12)
        check_model_map.set("Phase", json_model_13)
        check_model_map.set("Relation", json_model_14)
        check_model_map.set("Prereq", json_model_15)
        check_model_map.set("Prereqs", json_model_16)
    }
}

// differed module cleanup
export function check_model_free()
{
    if (initialized)
    {
        initialized = false;
    }
}

export function check_model(val, name, rep)
{
    let checker = check_model_map.get(name)
    if (checker === undefined)
        throw `no checker for "${name}"`
    let path = rep !== null ? [] : null

    return checker(val, path, rep)
}

// possibly run as main based on a guess
import main from "json_model_runtime/main.js"

if (import.meta.url.endsWith(process.argv[1]))
    main(check_model_init, check_model, check_model_free)
